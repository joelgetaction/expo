{"version":3,"file":"app.js","sourceRoot":"","sources":["../src/app.ts"],"names":[],"mappings":"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","sourcesContent":["import { NativeModulesProxy } from '@unimodules/core';\n\nimport SharedEventEmitter from './utils/SharedEventEmitter';\nimport INTERNALS from './utils/internals';\n\nimport { isObject } from './utils';\n\nimport { FirebaseOptions } from './types';\nimport { createAppModule } from './utils/createAppModule';\n\nimport { FirebaseNamespaces, DEFAULT_APP_NAME } from './constants';\n\nconst { ExpoFirebaseApp: FirebaseCoreModule } = NativeModulesProxy;\nexport default class App {\n  _extendedProps: { [key: string]: boolean };\n  _initialized: boolean = false;\n  _name: string;\n  _nativeInitialized: boolean = false;\n  _options: FirebaseOptions;\n\n  constructor(name: string, options: FirebaseOptions, fromNative: boolean = false) {\n    this._name = name;\n    this._options = Object.assign({}, options);\n\n    if (fromNative) {\n      this._initialized = true;\n      this._nativeInitialized = true;\n    } else if (options.databaseURL && options.apiKey) {\n      FirebaseCoreModule.initializeApp(this._name, this._options).then(result => {\n        this._initialized = true;\n        SharedEventEmitter.emit(`AppReady:${this._name}`, { error: null, result });\n      });\n    }\n\n    Object.keys(FirebaseNamespaces).map(namespace => {\n      this[namespace] = createAppModule(this, namespace);\n    });\n\n    this._extendedProps = {};\n  }\n\n  /**\n   *\n   * @return {*}\n   */\n  get name(): string {\n    return this._name;\n  }\n\n  /**\n   *\n   * @return {*}\n   */\n  get options(): FirebaseOptions {\n    return Object.assign({}, this._options);\n  }\n\n  /**\n   * Undocumented firebase web sdk method that allows adding additional properties onto\n   * a firebase app instance.\n   *\n   * See: https://github.com/firebase/firebase-js-sdk/blob/master/tests/app/firebase_app.test.ts#L328\n   *\n   * @param props\n   */\n  extendApp(props: Object) {\n    if (!isObject(props)) {\n      throw new Error(INTERNALS.STRINGS.ERROR_MISSING_ARG('Object', 'extendApp'));\n    }\n\n    const keys = Object.keys(props);\n\n    for (let i = 0, len = keys.length; i < len; i++) {\n      const key = keys[i];\n\n      if (!this._extendedProps[key] && Object.hasOwnProperty.call(this, key)) {\n        throw new Error(INTERNALS.STRINGS.ERROR_PROTECTED_PROP(key));\n      }\n\n      // $FlowExpectedError: Flow doesn't support indexable signatures on classes: https://github.com/facebook/flow/issues/1323\n      this[key] = props[key];\n      this._extendedProps[key] = true;\n    }\n  }\n\n  async delete(): Promise<any> {\n    if (this._name === DEFAULT_APP_NAME && this._nativeInitialized) {\n      throw new Error('Unable to delete the default native firebase app instance.');\n    }\n\n    return await FirebaseCoreModule.deleteApp(this._name);\n  }\n\n  async onReady(): Promise<App> {\n    if (this._initialized) {\n      return this;\n    }\n\n    return new Promise((resolve, reject) => {\n      SharedEventEmitter.once(`AppReady:${this._name}`, ({ error }) => {\n        if (error) return reject(new Error(error)); // error is a string as it's from native\n        return resolve(this); // return app\n      });\n    });\n  }\n\n  /**\n   * toString returns the name of the app.\n   *\n   * @return {string}\n   */\n  toString(): string {\n    return this._name;\n  }\n}\n"]}